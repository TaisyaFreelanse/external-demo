<template>
    <div class="min-h-screen bg-gradient-to-br from-[#0A0F1E] via-[#1A1F2E] to-[#0A0F1E] text-white">
      <div class="container mx-auto px-4 py-8 max-w-[1200px]">
        <!-- –ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é -->
        <DemoNavigation />
        
        <!-- Header -->
        <div class="mb-8">
          <div>
            <h1 class="text-4xl font-bold mb-1 bg-gradient-to-r from-[#007AFF] to-[#5E5CE6] bg-clip-text text-transparent">
              –ù–∞—Å—Ç—Ä–æ–π–∫–∏/—Ä–µ–≥–∏—Å—Ç—Ä
            </h1>
            <p class="text-white/60 text-sm">–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ API-–∫–ª—é—á–æ–º –∏ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ –≤–Ω–µ—à–Ω–µ–º—É API</p>
          </div>
        </div>
  
        <!-- –†–∞–∑–¥–µ–ª 1: –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ API-–∫–ª—é—á–æ–º -->
        <div class="bg-white/5 border border-white/10 rounded-2xl p-6 mb-6">
          <h2 class="text-2xl font-semibold mb-4">üîë –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ API-–∫–ª—é—á–æ–º</h2>
          <p class="text-white/60 text-sm mb-4">
            –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Ç–µ—Å—å –∏ –ø–æ–ª—É—á–∏—Ç–µ —É–Ω–∏–∫–∞–ª—å–Ω—ã–π API –∫–ª—é—á –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –≤–Ω–µ—à–Ω–∏–º API. Producer Name –±—É–¥–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏–≤—è–∑–∞–Ω –∫ –≤–∞—à–µ–º—É –∫–ª—é—á—É.
          </p>
          
          <!-- –¢–µ–∫—É—â–∏–π API-–∫–ª—é—á -->
          <div v-if="apiKey" class="mb-6 bg-green-500/10 border border-green-500/30 rounded-xl p-4">
            <div class="flex items-center justify-between mb-2">
              <p class="text-green-300 text-sm font-medium">–¢–µ–∫—É—â–∏–π API-–∫–ª—é—á:</p>
              <div class="flex gap-2">
                <button
                  @click="copyApiKey"
                  class="px-3 py-1.5 bg-white/10 hover:bg-white/20 rounded-lg text-white/70 text-xs transition-colors"
                >
                  {{ copied ? '‚úì –°–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–æ' : 'üìã –ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å' }}
                </button>
                <button
                  @click="clearApiKey"
                  class="px-3 py-1.5 bg-red-500/20 hover:bg-red-500/30 rounded-lg text-red-300 text-xs transition-colors"
                >
                  üóëÔ∏è –û—á–∏—Å—Ç–∏—Ç—å
                </button>
              </div>
            </div>
            <pre class="text-green-200 text-xs font-mono break-all bg-black/30 p-2 rounded">{{ apiKey }}</pre>
          </div>
  
          <!-- –§–æ—Ä–º–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ -->
          <form @submit.prevent="register" class="space-y-4">
            <div>
              <label class="block text-sm font-medium text-white/80 mb-2">
                Producer Name <span class="text-red-400">*</span>
              </label>
              <input 
                v-model="registerForm.producerCode"
                type="text" 
                required
                placeholder="–ø—Ä–æ–¥1"
                class="w-full bg-white/5 border border-white/10 rounded-xl px-4 py-3 text-white placeholder-white/30 focus:border-[#007AFF] focus:ring-2 focus:ring-[#007AFF]/20 outline-none transition-all"
              >
              <p class="text-xs text-white/50 mt-1">–û—Ç–æ–±—Ä–∞–∂–∞–µ–º–æ–µ –∏–º—è –ø—Ä–æ–¥—é—Å–µ—Ä–∞ (–±—É–¥–µ—Ç –ø—Ä–∏–≤—è–∑–∞–Ω–æ –∫ API –∫–ª—é—á—É)</p>
            </div>
  
            <button
              type="submit"
              :disabled="isRegistering"
              class="w-full bg-gradient-to-r from-purple-500 to-pink-600 text-white font-semibold py-3 px-6 rounded-xl hover:opacity-90 transition-opacity disabled:opacity-50 disabled:cursor-not-allowed"
            >
              {{ isRegistering ? '–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è...' : '–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è –∏ –ø–æ–ª—É—á–∏—Ç—å API –∫–ª—é—á' }}
            </button>
          </form>
  
          <!-- –°–æ–æ–±—â–µ–Ω–∏–µ –æ –ø—Ä–æ–≥—Ä–µ—Å—Å–µ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ -->
          <div v-if="registerProgressMessage && isRegistering" class="mt-4 bg-blue-500/10 border border-blue-500/30 rounded-xl p-4">
            <div class="flex items-center gap-2">
              <svg class="animate-spin h-5 w-5 text-blue-300" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
              </svg>
              <p class="text-blue-300 text-sm">{{ registerProgressMessage }}</p>
            </div>
          </div>
  
          <div v-if="registerResponse" class="mt-4 bg-green-500/10 border border-green-500/30 rounded-xl p-4">
            <p class="text-green-300 text-sm font-medium mb-2">–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è —É—Å–ø–µ—à–Ω–∞!</p>
            <p class="text-green-200/70 text-xs mb-2">–í–∞—à API –∫–ª—é—á (—Å–æ—Ö—Ä–∞–Ω–µ–Ω –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏):</p>
            <pre class="text-green-200 text-xs font-mono break-all bg-black/30 p-2 rounded mb-4">{{ registerResponse.data?.apiKey || registerResponse.apiKey }}</pre>
          </div>
  
          <div v-if="registerError" class="mt-4 bg-red-500/20 border border-red-500/50 rounded-xl p-4">
            <p class="text-red-300 text-sm font-medium mb-2">–û—à–∏–±–∫–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏</p>
            <ul class="space-y-1">
              <li v-for="(errorMessage, index) in formattedRegisterErrors" :key="index" class="text-red-300 text-xs">
                {{ errorMessage }}
              </li>
            </ul>
          </div>
        </div>
  
        <!-- –†–∞–∑–¥–µ–ª 2: –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è API -->
        <div class="bg-white/5 border border-white/10 rounded-2xl p-6">
          <h2 class="text-2xl font-semibold mb-4">üìö –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –≤–Ω–µ—à–Ω–µ–≥–æ API</h2>
          
          <div class="space-y-6">
            <!-- –û–±—â–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è -->
            <div>
              <h3 class="text-xl font-semibold mb-3 text-[#007AFF]">–û–±—â–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</h3>
              <div class="bg-black/30 rounded-xl p-4 space-y-3 text-sm">
                <p class="text-white/80">
                  <strong class="text-white">–ë–∞–∑–æ–≤—ã–π URL:</strong> <code class="bg-white/10 px-2 py-1 rounded">{{ apiBaseUrl }}/api/external</code>
                </p>
                <p class="text-white/80">
                  <strong class="text-white">–ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è:</strong> –í—Å–µ –∑–∞–ø—Ä–æ—Å—ã (–∫—Ä–æ–º–µ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏) —Ç—Ä–µ–±—É—é—Ç –∑–∞–≥–æ–ª–æ–≤–æ–∫ <code class="bg-white/10 px-2 py-1 rounded">Authorization: Bearer YOUR_API_KEY</code>
                </p>
                <p class="text-white/80">
                  <strong class="text-white">–§–æ—Ä–º–∞—Ç –¥–∞–Ω–Ω—ã—Ö:</strong> JSON (Content-Type: application/json)
                </p>
                <p class="text-white/80">
                  <strong class="text-white">–§–æ—Ä–º–∞—Ç –æ—Ç–≤–µ—Ç–æ–≤:</strong> –í—Å–µ –æ—Ç–≤–µ—Ç—ã –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç—Å—è –≤ —Ñ–æ—Ä–º–∞—Ç–µ JSON —Å –ø–æ–ª—è–º–∏ <code class="bg-white/10 px-2 py-1 rounded">success</code>, <code class="bg-white/10 px-2 py-1 rounded">data</code>, <code class="bg-white/10 px-2 py-1 rounded">message</code>, <code class="bg-white/10 px-2 py-1 rounded">errors</code>
                </p>
              </div>
            </div>
  
            <!-- –≠–Ω–¥–ø–æ–∏–Ω—Ç 1: –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è -->
            <div>
              <h3 class="text-xl font-semibold mb-3 text-[#007AFF]">1. –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –∏ –ø–æ–ª—É—á–µ–Ω–∏–µ API-–∫–ª—é—á–∞</h3>
              <div class="bg-black/30 rounded-xl p-4 space-y-3">
                <div>
                  <p class="text-white font-medium mb-2">POST <code class="bg-white/10 px-2 py-1 rounded">/api/external/register</code></p>
                  <p class="text-white/70 text-sm mb-3">–†–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–µ—Ç –Ω–æ–≤–æ–≥–æ –ø—Ä–æ–¥—é—Å–µ—Ä–∞ –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç API-–∫–ª—é—á –¥–ª—è –¥–∞–ª—å–Ω–µ–π—à–µ–π —Ä–∞–±–æ—Ç—ã.</p>
                </div>
  
                <div>
                  <p class="text-white font-medium mb-2">–ü–∞—Ä–∞–º–µ—Ç—Ä—ã –∑–∞–ø—Ä–æ—Å–∞:</p>
                  <pre class="bg-black/50 rounded-lg p-3 text-xs overflow-x-auto"><code>{
    "producerCode": "string"  // –ò–º—è –ø—Ä–æ–¥—é—Å–µ—Ä–∞ (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)
  }</code></pre>
                </div>
  
                <div>
                  <p class="text-white font-medium mb-2">–ü—Ä–∏–º–µ—Ä —É—Å–ø–µ—à–Ω–æ–≥–æ –æ—Ç–≤–µ—Ç–∞ (200 OK):</p>
                  <pre class="bg-black/50 rounded-lg p-3 text-xs overflow-x-auto"><code>{
    "success": true,
    "data": {
      "apiKey": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",
      "producerCode": "–ø—Ä–æ–¥1"
    },
    "message": "–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è —É—Å–ø–µ—à–Ω–∞"
  }</code></pre>
                </div>
  
                <div>
                  <p class="text-white font-medium mb-2">–ü—Ä–∏–º–µ—Ä –æ—Ç–≤–µ—Ç–∞ —Å –æ—à–∏–±–∫–æ–π (400 Bad Request):</p>
                  <pre class="bg-black/50 rounded-lg p-3 text-xs overflow-x-auto"><code>{
    "success": false,
    "errors": [
      {
        "message": "Producer Code —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç"
      }
    ],
    "message": "–û—à–∏–±–∫–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–∏"
  }</code></pre>
                </div>
  
                <div>
                  <p class="text-white font-medium mb-2">–ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è (JavaScript):</p>
                  <pre class="bg-black/50 rounded-lg p-3 text-xs overflow-x-auto"><code>const response = await fetch('{{ apiBaseUrl }}/api/external/register', {
    method: 'POST',
    headers: {
      'Content-Type': 'application/json'
    },
    body: JSON.stringify({
      producerCode: '–ø—Ä–æ–¥1'
    })
  });
  
  const data = await response.json();
  if (data.success) {
    console.log('API Key:', data.data.apiKey);
  }</code></pre>
                </div>
              </div>
            </div>
  
            <!-- –≠–Ω–¥–ø–æ–∏–Ω—Ç 2: –°–æ–∑–¥–∞–Ω–∏–µ/–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–æ–±—ã—Ç–∏—è -->
            <div>
              <h3 class="text-xl font-semibold mb-3 text-[#007AFF]">2. –°–æ–∑–¥–∞–Ω–∏–µ/–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–æ–±—ã—Ç–∏—è</h3>
              <div class="bg-black/30 rounded-xl p-4 space-y-3">
                <div>
                  <p class="text-white font-medium mb-2">POST <code class="bg-white/10 px-2 py-1 rounded">/api/external/events</code></p>
                  <p class="text-white/70 text-sm mb-3">–°–æ–∑–¥–∞–µ—Ç –Ω–æ–≤–æ–µ —Å–æ–±—ã—Ç–∏–µ –∏–ª–∏ –æ–±–Ω–æ–≤–ª—è–µ—Ç —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–µ (–µ—Å–ª–∏ –ø–µ—Ä–µ–¥–∞–Ω <code class="bg-white/10 px-1 rounded">id</code>). –¢—Ä–µ–±—É–µ—Ç –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é —á–µ—Ä–µ–∑ API-–∫–ª—é—á.</p>
                </div>
  
                <div>
                  <p class="text-white font-medium mb-2">–ü–∞—Ä–∞–º–µ—Ç—Ä—ã –∑–∞–ø—Ä–æ—Å–∞:</p>
                  <pre class="bg-black/50 rounded-lg p-3 text-xs overflow-x-auto"><code>{
    "id": "string",                    // ID —Å–æ–±—ã—Ç–∏—è (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è)
    "title": "string",                 // –ù–∞–∑–≤–∞–Ω–∏–µ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)
    "authorName": "string",            // –ò–º—è –∞–≤—Ç–æ—Ä–∞ –≤ —Å–≤–æ–±–æ–¥–Ω–æ–π —Ñ–æ—Ä–º–µ (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)
    "location": "string",              // –ú–µ—Å—Ç–æ –ø—Ä–æ–≤–µ–¥–µ–Ω–∏—è (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)
    "seatLimit": number,               // –õ–∏–º–∏—Ç –º–µ—Å—Ç (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)
    "pricePerSeat": number,            // –¶–µ–Ω–∞ –∑–∞ –º–µ—Å—Ç–æ –≤ —Ä—É–±–ª—è—Ö (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)
    "description": "string",           // –û–ø–∏—Å–∞–Ω–∏–µ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
    "timezone": "string",              // IANA timezone (–Ω–∞–ø—Ä–∏–º–µ—Ä, "Europe/Moscow") (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)
    "createdAtClient": "ISO8601",      // –î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è –Ω–∞ –∫–ª–∏–µ–Ω—Ç–µ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
    "startApplicationsAt": "ISO8601", // –ù–∞—á–∞–ª–æ –ø—Ä–∏–µ–º–∞ –∑–∞—è–≤–æ–∫ (ti10) (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)
    "endApplicationsAt": "ISO8601",    // –û–∫–æ–Ω—á–∞–Ω–∏–µ –ø—Ä–∏–µ–º–∞ –∑–∞—è–≤–æ–∫ (ti20) (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)
    "startContractsAt": "ISO8601",     // –ù–∞—á–∞–ª–æ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—è –¥–æ–≥–æ–≤–æ—Ä–æ–≤ (ti30) (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)
    "startAt": "ISO8601",              // –ù–∞—á–∞–ª–æ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è (ti40) (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)
    "endAt": "ISO8601"                 // –û–∫–æ–Ω—á–∞–Ω–∏–µ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è (ti50) (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
  }</code></pre>
                  <p class="text-white/60 text-xs mt-2">
                    <strong>–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:</strong> –í—Å–µ –¥–∞—Ç—ã –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –≤ —Ñ–æ—Ä–º–∞—Ç–µ ISO 8601 (–Ω–∞–ø—Ä–∏–º–µ—Ä, "2025-11-15T14:30:00.000Z"). 
                    –ï—Å–ª–∏ –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è <code class="bg-white/10 px-1 rounded">id</code>, —Å–æ–±—ã—Ç–∏–µ –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è; –∏–Ω–∞—á–µ —Å–æ–∑–¥–∞–µ—Ç—Å—è –Ω–æ–≤–æ–µ.
                  </p>
                </div>
  
                <div>
                  <p class="text-white font-medium mb-2">–ü—Ä–∏–º–µ—Ä —É—Å–ø–µ—à–Ω–æ–≥–æ –æ—Ç–≤–µ—Ç–∞ (200 OK):</p>
                  <pre class="bg-black/50 rounded-lg p-3 text-xs overflow-x-auto"><code>{
    "success": true,
    "data": {
      "id": "evt_1234567890",
      "title": "–ú–∞—Å—Ç–µ—Ä-–∫–ª–∞—Å—Å –ø–æ –∫—É–ª–∏–Ω–∞—Ä–∏–∏",
      "status": "draft",
      "createdAt": "2025-11-15T10:00:00.000Z",
      "updatedAt": "2025-11-15T10:00:00.000Z"
    },
    "message": "–°–æ–±—ã—Ç–∏–µ —É—Å–ø–µ—à–Ω–æ —Å–æ–∑–¥–∞–Ω–æ"
  }</code></pre>
                </div>
  
                <div>
                  <p class="text-white font-medium mb-2">–ü—Ä–∏–º–µ—Ä –æ—Ç–≤–µ—Ç–∞ —Å –æ—à–∏–±–∫–æ–π (400 Bad Request):</p>
                  <pre class="bg-black/50 rounded-lg p-3 text-xs overflow-x-auto"><code>{
    "success": false,
    "errors": [
      {
        "message": "–ü–æ–ª–µ 'title' –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –¥–ª—è –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è"
      },
      {
        "message": "–î–∞—Ç–∞ –æ–∫–æ–Ω—á–∞–Ω–∏—è –ø—Ä–∏–µ–º–∞ –∑–∞—è–≤–æ–∫ –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –ø–æ–∑–∂–µ –¥–∞—Ç—ã –Ω–∞—á–∞–ª–∞"
      }
    ],
    "message": "–û—à–∏–±–∫–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–∏"
  }</code></pre>
                </div>
  
                <div>
                  <p class="text-white font-medium mb-2">–ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è (JavaScript):</p>
                  <pre class="bg-black/50 rounded-lg p-3 text-xs overflow-x-auto"><code>const apiKey = 'YOUR_API_KEY';
  const eventData = {
    title: '–ú–∞—Å—Ç–µ—Ä-–∫–ª–∞—Å—Å –ø–æ –∫—É–ª–∏–Ω–∞—Ä–∏–∏',
    authorName: '–ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤',
    location: '–ú–æ—Å–∫–≤–∞, —É–ª. –ü—Ä–∏–º–µ—Ä–Ω–∞—è, 1',
    seatLimit: 20,
    pricePerSeat: 5000,
    description: '–£–≤–ª–µ–∫–∞—Ç–µ–ª—å–Ω—ã–π –º–∞—Å—Ç–µ—Ä-–∫–ª–∞—Å—Å...',
    timezone: 'Europe/Moscow',
    startApplicationsAt: '2025-11-15T10:00:00.000Z',
    endApplicationsAt: '2025-11-20T18:00:00.000Z',
    startContractsAt: '2025-11-21T10:00:00.000Z',
    startAt: '2025-11-25T14:00:00.000Z',
    endAt: '2025-11-25T18:00:00.000Z'
  };
  
  const response = await fetch('{{ apiBaseUrl }}/api/external/events', {
    method: 'POST',
    headers: {
      'Content-Type': 'application/json',
      'Authorization': `Bearer ${apiKey}`
    },
    body: JSON.stringify(eventData)
  });
  
  const data = await response.json();
  if (data.success) {
    console.log('–°–æ–±—ã—Ç–∏–µ —Å–æ–∑–¥–∞–Ω–æ:', data.data.id);
  }</code></pre>
                </div>
              </div>
            </div>
  
            <!-- –≠–Ω–¥–ø–æ–∏–Ω—Ç 3: –ü–æ–ª—É—á–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ —Å–æ–±—ã—Ç–∏—è -->
            <div>
              <h3 class="text-xl font-semibold mb-3 text-[#007AFF]">3. –ü–æ–ª—É—á–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ —Å–æ–±—ã—Ç–∏—è</h3>
              <div class="bg-black/30 rounded-xl p-4 space-y-3">
                <div>
                  <p class="text-white font-medium mb-2">GET <code class="bg-white/10 px-2 py-1 rounded">/api/external/events/:id</code></p>
                  <p class="text-white/70 text-sm mb-3">–ü–æ–ª—É—á–∞–µ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Å–æ–±—ã—Ç–∏–∏ –ø–æ –µ–≥–æ ID. –¢—Ä–µ–±—É–µ—Ç –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é —á–µ—Ä–µ–∑ API-–∫–ª—é—á. –ü–æ–∑–≤–æ–ª—è–µ—Ç –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å –ø—É–±–ª–∏–∫–∞—Ü–∏–∏ –∏ –∞–∫—Ç—É–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ —Å–æ–±—ã—Ç–∏—è –Ω–∞ –ø–ª–∞—Ç—Ñ–æ—Ä–º–µ.</p>
                </div>
  
                <div>
                  <p class="text-white font-medium mb-2">–ü–∞—Ä–∞–º–µ—Ç—Ä—ã URL:</p>
                  <ul class="list-disc list-inside text-white/70 text-sm space-y-1 ml-4">
                    <li><code class="bg-white/10 px-1 rounded">:id</code> ‚Äî ID —Å–æ–±—ã—Ç–∏—è –Ω–∞ –ø–ª–∞—Ç—Ñ–æ—Ä–º–µ (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)</li>
                  </ul>
                </div>
  
                <div>
                  <p class="text-white font-medium mb-2">–ü—Ä–∏–º–µ—Ä —É—Å–ø–µ—à–Ω–æ–≥–æ –æ—Ç–≤–µ—Ç–∞ (200 OK):</p>
                  <pre class="bg-black/50 rounded-lg p-3 text-xs overflow-x-auto"><code>{
    "success": true,
    "data": {
      "id": "evt_1234567890",
      "title": "–ú–∞—Å—Ç–µ—Ä-–∫–ª–∞—Å—Å –ø–æ –∫—É–ª–∏–Ω–∞—Ä–∏–∏",
      "authorName": "–ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤",
      "location": "–ú–æ—Å–∫–≤–∞, —É–ª. –ü—Ä–∏–º–µ—Ä–Ω–∞—è, 1",
      "seatLimit": 20,
      "pricePerSeat": 5000,
      "status": "published",
      "isPublished": true,
      "createdAt": "2025-11-15T10:00:00.000Z",
      "updatedAt": "2025-11-15T12:00:00.000Z",
      "startApplicationsAt": "2025-11-15T10:00:00.000Z",
      "endApplicationsAt": "2025-11-20T18:00:00.000Z",
      "startContractsAt": "2025-11-21T10:00:00.000Z",
      "startAt": "2025-11-25T14:00:00.000Z",
      "endAt": "2025-11-25T18:00:00.000Z"
    },
    "message": "–°–æ–±—ã—Ç–∏–µ –Ω–∞–π–¥–µ–Ω–æ"
  }</code></pre>
                </div>
  
                <div>
                  <p class="text-white font-medium mb-2">–ü—Ä–∏–º–µ—Ä –æ—Ç–≤–µ—Ç–∞ —Å –æ—à–∏–±–∫–æ–π (404 Not Found):</p>
                  <pre class="bg-black/50 rounded-lg p-3 text-xs overflow-x-auto"><code>{
    "success": false,
    "message": "–°–æ–±—ã—Ç–∏–µ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ",
    "errors": [
      {
        "message": "–°–æ–±—ã—Ç–∏–µ —Å —É–∫–∞–∑–∞–Ω–Ω—ã–º ID –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç"
      }
    ]
  }</code></pre>
                </div>
  
                <div>
                  <p class="text-white font-medium mb-2">–ü—Ä–∏–º–µ—Ä –æ—Ç–≤–µ—Ç–∞ —Å –æ—à–∏–±–∫–æ–π –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ (401 Unauthorized):</p>
                  <pre class="bg-black/50 rounded-lg p-3 text-xs overflow-x-auto"><code>{
    "success": false,
    "message": "–ù–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω",
    "errors": [
      {
        "message": "–ù–µ–≤–µ—Ä–Ω—ã–π –∏–ª–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∏–π API-–∫–ª—é—á"
      }
    ]
  }</code></pre>
                </div>
  
                <div>
                  <p class="text-white font-medium mb-2">–ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è (JavaScript):</p>
                  <pre class="bg-black/50 rounded-lg p-3 text-xs overflow-x-auto"><code>const apiKey = 'YOUR_API_KEY';
  const eventId = 'evt_1234567890';
  
  const response = await fetch(`{{ apiBaseUrl }}/api/external/events/${eventId}`, {
    method: 'GET',
    headers: {
      'Authorization': `Bearer ${apiKey}`
    }
  });
  
  const data = await response.json();
  if (data.success) {
    console.log('–°—Ç–∞—Ç—É—Å —Å–æ–±—ã—Ç–∏—è:', data.data.status);
    console.log('–û–ø—É–±–ª–∏–∫–æ–≤–∞–Ω–æ:', data.data.isPublished);
  }</code></pre>
                </div>
              </div>
            </div>
  
            <!-- –ö–æ–¥—ã –æ—à–∏–±–æ–∫ -->
            <div>
              <h3 class="text-xl font-semibold mb-3 text-[#007AFF]">–ö–æ–¥—ã –æ—à–∏–±–æ–∫ HTTP</h3>
              <div class="bg-black/30 rounded-xl p-4">
                <div class="space-y-2 text-sm">
                  <div class="flex items-start gap-3">
                    <code class="bg-red-500/20 text-red-300 px-2 py-1 rounded min-w-[80px] text-center">400</code>
                    <div>
                      <p class="text-white font-medium">Bad Request</p>
                      <p class="text-white/60">–û—à–∏–±–∫–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–∞</p>
                    </div>
                  </div>
                  <div class="flex items-start gap-3">
                    <code class="bg-red-500/20 text-red-300 px-2 py-1 rounded min-w-[80px] text-center">401</code>
                    <div>
                      <p class="text-white font-medium">Unauthorized</p>
                      <p class="text-white/60">–ù–µ–≤–µ—Ä–Ω—ã–π –∏–ª–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∏–π API-–∫–ª—é—á</p>
                    </div>
                  </div>
                  <div class="flex items-start gap-3">
                    <code class="bg-red-500/20 text-red-300 px-2 py-1 rounded min-w-[80px] text-center">403</code>
                    <div>
                      <p class="text-white font-medium">Forbidden</p>
                      <p class="text-white/60">–î–æ—Å—Ç—É–ø –∑–∞–ø—Ä–µ—â–µ–Ω (—Å–æ–±—ã—Ç–∏–µ –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–∏—Ç –¥—Ä—É–≥–æ–º—É –ø—Ä–æ–¥—é—Å–µ—Ä—É)</p>
                    </div>
                  </div>
                  <div class="flex items-start gap-3">
                    <code class="bg-red-500/20 text-red-300 px-2 py-1 rounded min-w-[80px] text-center">404</code>
                    <div>
                      <p class="text-white font-medium">Not Found</p>
                      <p class="text-white/60">–†–µ—Å—É—Ä—Å –Ω–µ –Ω–∞–π–¥–µ–Ω</p>
                    </div>
                  </div>
                  <div class="flex items-start gap-3">
                    <code class="bg-red-500/20 text-red-300 px-2 py-1 rounded min-w-[80px] text-center">500</code>
                    <div>
                      <p class="text-white font-medium">Internal Server Error</p>
                      <p class="text-white/60">–í–Ω—É—Ç—Ä–µ–Ω–Ω—è—è –æ—à–∏–±–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞</p>
                    </div>
                  </div>
                </div>
              </div>
            </div>
  
            <!-- –í–∞–∂–Ω—ã–µ –∑–∞–º–µ—á–∞–Ω–∏—è -->
            <div>
              <h3 class="text-xl font-semibold mb-3 text-[#007AFF]">‚ö†Ô∏è –í–∞–∂–Ω—ã–µ –∑–∞–º–µ—á–∞–Ω–∏—è</h3>
              <div class="bg-yellow-500/10 border border-yellow-500/30 rounded-xl p-4 space-y-2 text-sm">
                <p class="text-yellow-200">
                  <strong>1. –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å API-–∫–ª—é—á–∞:</strong> –ù–∏–∫–æ–≥–¥–∞ –Ω–µ –ø—É–±–ª–∏–∫—É–π—Ç–µ –≤–∞—à API-–∫–ª—é—á –≤ –ø—É–±–ª–∏—á–Ω—ã—Ö —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è—Ö –∏–ª–∏ –∫–ª–∏–µ–Ω—Ç—Å–∫–æ–º –∫–æ–¥–µ. –•—Ä–∞–Ω–∏—Ç–µ –µ–≥–æ –≤ –±–µ–∑–æ–ø–∞—Å–Ω–æ–º –º–µ—Å—Ç–µ.
                </p>
                <p class="text-yellow-200">
                  <strong>2. –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:</strong> –ü–æ—Å–ª–µ –Ω–∞—Å—Ç—É–ø–ª–µ–Ω–∏—è –∫–æ–Ω—Ç—Ä–æ–ª—å–Ω–æ–π —Ç–æ—á–∫–∏ –¢–∏20 (–æ–∫–æ–Ω—á–∞–Ω–∏–µ –ø—Ä–∏–µ–º–∞ –∑–∞—è–≤–æ–∫) —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–æ–±—ã—Ç–∏—è –Ω–∞ –ø–ª–∞—Ç—Ñ–æ—Ä–º–µ –±–ª–æ–∫–∏—Ä—É–µ—Ç—Å—è.
                </p>
                <p class="text-yellow-200">
                  <strong>3. –§–æ—Ä–º–∞—Ç –¥–∞—Ç:</strong> –í—Å–µ –¥–∞—Ç—ã –¥–æ–ª–∂–Ω—ã –ø–µ—Ä–µ–¥–∞–≤–∞—Ç—å—Å—è –≤ —Ñ–æ—Ä–º–∞—Ç–µ ISO 8601 —Å —É–∫–∞–∑–∞–Ω–∏–µ–º —á–∞—Å–æ–≤–æ–≥–æ –ø–æ—è—Å–∞ –∏–ª–∏ –≤ UTC.
                </p>
                <p class="text-yellow-200">
                  <strong>4. –í–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö:</strong> –ü–ª–∞—Ç—Ñ–æ—Ä–º–∞ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å –≤—Å–µ—Ö –ø–µ—Ä–µ–¥–∞–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –¥–∞—Ç—ã —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—Ç –ª–æ–≥–∏–∫–µ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Ç–æ—á–µ–∫ (ti10 &lt; ti20 &lt; ti30 &lt; ti40).
                </p>
                <p class="text-yellow-200">
                  <strong>5. –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–æ–±—ã—Ç–∏–π:</strong> –ü—Ä–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ —Å–æ–±—ã—Ç–∏—è –ø–µ—Ä–µ–¥–∞–≤–∞–π—Ç–µ –ø–æ–ª–Ω—ã–π –Ω–∞–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö, –∞ –Ω–µ —Ç–æ–ª—å–∫–æ –∏–∑–º–µ–Ω–µ–Ω–Ω—ã–µ –ø–æ–ª—è.
                </p>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </template>
  
  <script setup lang="ts">
  import { ref, computed, onMounted, onUnmounted } from 'vue'
  
  const config = useRuntimeConfig()
  const apiBaseUrl = config.public.apiBaseUrl
  
  // API Key management
  const apiKey = ref<string>('')
  const copied = ref(false)
  
  // –§–æ—Ä–º–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏
  const registerForm = ref({
    producerCode: '' // –í–Ω—É—Ç—Ä–µ–Ω–Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ–º producerCode –¥–ª—è —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è API
  })
  
  const isRegistering = ref(false)
  const registerResponse = ref<any>(null)
  const registerError = ref<any>(null)
  const registerProgressMessage = ref<string>('')
  const registerStartTime = ref<number | null>(null)
  let registerProgressInterval: NodeJS.Timeout | null = null
  
  const formattedRegisterErrors = computed(() => {
    if (!registerError.value) return []
    
    if (registerError.value.errors && Array.isArray(registerError.value.errors)) {
      return registerError.value.errors.map((err: any) => err.message || err)
    }
    
    if (registerError.value.message) {
      return [registerError.value.message]
    }
    
    if (typeof registerError.value === 'string') {
      return [registerError.value]
    }
    
    return ['–ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞ –ø—Ä–∏ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏']
  })
  
  // –ó–∞–≥—Ä—É–∑–∫–∞ API –∫–ª—é—á–∞
  const loadApiKey = () => {
    if (typeof window !== 'undefined') {
      apiKey.value = localStorage.getItem('external_api_key') || ''
    }
  }
  
  // –ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ API –∫–ª—é—á–∞
  const copyApiKey = async () => {
    if (apiKey.value && typeof navigator !== 'undefined' && navigator.clipboard) {
      await navigator.clipboard.writeText(apiKey.value)
      copied.value = true
      setTimeout(() => { copied.value = false }, 2000)
    }
  }
  
  // –û—á–∏—Å—Ç–∫–∞ API –∫–ª—é—á–∞
  const clearApiKey = () => {
    if (confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ –æ—á–∏—Å—Ç–∏—Ç—å API –∫–ª—é—á?')) {
      if (typeof window !== 'undefined') {
        localStorage.removeItem('external_api_key')
        apiKey.value = ''
      }
    }
  }
  
  // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ API –∫–ª—é—á–∞
  const saveApiKey = (key: string) => {
    if (typeof window !== 'undefined') {
      localStorage.setItem('external_api_key', key)
      apiKey.value = key
    }
  }
  
  const register = async () => {
    isRegistering.value = true
    registerError.value = null
    registerResponse.value = null
    registerProgressMessage.value = '–ù–∞—á–∞–ª–æ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏...'
    registerStartTime.value = Date.now()
  
    // –û—á–∏—â–∞–µ–º –ø—Ä–µ–¥—ã–¥—É—â–∏–π –∏–Ω—Ç–µ—Ä–≤–∞–ª, –µ—Å–ª–∏ –æ–Ω –µ—Å—Ç—å
    if (registerProgressInterval) {
      clearInterval(registerProgressInterval)
      registerProgressInterval = null
    }
  
    // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å–æ–æ–±—â–µ–Ω–∏—è –æ –ø—Ä–æ–≥—Ä–µ—Å—Å–µ
    const updateProgressMessage = () => {
      if (registerStartTime.value) {
        const elapsedSeconds = Math.floor((Date.now() - registerStartTime.value) / 1000)
        const minutes = Math.floor(elapsedSeconds / 60)
        const seconds = elapsedSeconds % 60
        
        if (minutes > 0) {
          registerProgressMessage.value = `–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è —É–∂–µ ${minutes} ${minutes === 1 ? '–º–∏–Ω—É—Ç—É' : minutes < 5 ? '–º–∏–Ω—É—Ç—ã' : '–º–∏–Ω—É—Ç'} ${seconds > 0 ? `–∏ ${seconds} ${seconds === 1 ? '—Å–µ–∫—É–Ω–¥—É' : seconds < 5 ? '—Å–µ–∫—É–Ω–¥—ã' : '—Å–µ–∫—É–Ω–¥'}` : ''}. –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø–æ–¥–æ–∂–¥–∏—Ç–µ...`
        } else {
          registerProgressMessage.value = `–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è —É–∂–µ ${elapsedSeconds} ${elapsedSeconds === 1 ? '—Å–µ–∫—É–Ω–¥—É' : elapsedSeconds < 5 ? '—Å–µ–∫—É–Ω–¥—ã' : '—Å–µ–∫—É–Ω–¥'}. –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø–æ–¥–æ–∂–¥–∏—Ç–µ...`
        }
      }
    }
  
    // –û–±–Ω–æ–≤–ª—è–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ —Å—Ä–∞–∑—É
    updateProgressMessage()
  
    // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∏–Ω—Ç–µ—Ä–≤–∞–ª –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å–æ–æ–±—â–µ–Ω–∏—è –∫–∞–∂–¥—ã–µ 5 —Å–µ–∫—É–Ω–¥
    registerProgressInterval = setInterval(updateProgressMessage, 5000)
  
    try {
      const res = await fetch(`${apiBaseUrl}/api/external/register`, {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json'
        },
        body: JSON.stringify(registerForm.value)
      })
  
      const data = await res.json()
      
      if (res.ok && data.success) {
        registerResponse.value = data
        if (data.data?.apiKey) {
          saveApiKey(data.data.apiKey)
        }
        registerProgressMessage.value = '–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è —É—Å–ø–µ—à–Ω–æ –∑–∞–≤–µ—Ä—à–µ–Ω–∞!'
      } else {
        registerError.value = data
        registerProgressMessage.value = ''
      }
    } catch (err: any) {
      registerError.value = { message: err.message || '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –æ—à–∏–±–∫–∞' }
      registerProgressMessage.value = ''
    } finally {
      isRegistering.value = false
      registerStartTime.value = null
      
      // –û—á–∏—â–∞–µ–º –∏–Ω—Ç–µ—Ä–≤–∞–ª
      if (registerProgressInterval) {
        clearInterval(registerProgressInterval)
        registerProgressInterval = null
      }
      
      // –û—á–∏—â–∞–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ —á–µ—Ä–µ–∑ 3 —Å–µ–∫—É–Ω–¥—ã –ø–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è
      setTimeout(() => {
        registerProgressMessage.value = ''
      }, 3000)
    }
  }
  
  onMounted(() => {
    loadApiKey()
  })
  
  // –û—á–∏—Å—Ç–∫–∞ –∏–Ω—Ç–µ—Ä–≤–∞–ª–∞ –ø—Ä–∏ —Ä–∞–∑–º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞
  onUnmounted(() => {
    if (registerProgressInterval) {
      clearInterval(registerProgressInterval)
      registerProgressInterval = null
    }
  })
  </script>
  
  